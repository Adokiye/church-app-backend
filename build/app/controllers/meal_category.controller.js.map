{"version":3,"sources":["../../../src/app/controllers/meal_category.controller.js"],"names":["updateMealCategory","ctx","body","request","role","state","user","meal_category_id","images","JSON","stringify","MealCategory","query","patchAndFetchById","withGraphFetched","e","console","log","meal_category_data","status","message","getMealCategories","data","getMealCategorySelectionTypes","MealCategorySelectionType","meal_category_selection_type_data"],"mappings":";;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;AAEO,IAAMA,kBAAkB;AAAA,2FAAG,iBAAMC,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACxBC,YAAAA,IADwB,GACfD,GAAG,CAACE,OADW,CACxBD,IADwB;AAExBE,YAAAA,IAFwB,GAEfH,GAAG,CAACI,KAAJ,CAAUC,IAAV,CAAeA,IAFA,CAExBF,IAFwB;AAG5BG,YAAAA,gBAH4B,GAGTL,IAAI,CAACK,gBAHI;AAIhC,mBAAOL,IAAI,CAACK,gBAAZ;AAJgC;AAAA,mBAKtB,mCAAiBH,IAAjB,CALsB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAM9B,gBAAGF,IAAI,CAACM,MAAR,EAAe;AACbN,cAAAA,IAAI,CAACM,MAAL,GAAcC,IAAI,CAACC,SAAL,CAAeR,IAAI,CAACM,MAApB,CAAd;AACD;;AAR6B;AAAA,mBAUSG,0BAAaC,KAAb,GACpCC,iBADoC,CAClBN,gBADkB,EACAL,IADA,EAEpCY,gBAFoC,CAEnB,kBAFmB,WAG9B,UAAAC,CAAC,EAAI;AACVC,cAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,oBAAM,kCAAoB,cAApB,CAAN;AACD,aANoC,CAVT;;AAAA;AAUxBG,YAAAA,kBAVwB;AAAA;AAkB5BC,cAAAA,MAAM,EAAE,SAlBoB;AAmB5BC,cAAAA,OAAO,EAAE;AAnBmB,eAoBzBF,kBApByB;;AAAA;AAAA,kBAuBxB,2BAAa,cAAb,CAvBwB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlBlB,kBAAkB;AAAA;AAAA;AAAA,GAAxB;;;;AA2BA,IAAMqB,iBAAiB;AAAA,4FAAG,kBAAMpB,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACQU,0BAAaC,KAAb,GACpCE,gBADoC,CACnB,gCADmB,WAE9B,UAAAC,CAAC,EAAI;AACVC,cAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,qBAAO,EAAP;AACD,aALoC,CADR;;AAAA;AACzBG,YAAAA,kBADyB;AAAA,8CAOxB;AACLC,cAAAA,MAAM,EAAE,SADH;AAELC,cAAAA,OAAO,EAAE,uCAFJ;AAGLE,cAAAA,IAAI,EAAEJ;AAHD,aAPwB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjBG,iBAAiB;AAAA;AAAA;AAAA,GAAvB;;;;AAcA,IAAME,6BAA6B;AAAA,4FAAG,kBAAMtB,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACWuB,yCAA0BZ,KAA1B,GACtD;AADsD,sBAE7C,UAAAG,CAAC,EAAI;AACVC,cAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,qBAAO,EAAP;AACD,aALmD,CADX;;AAAA;AACrCU,YAAAA,iCADqC;AAAA,8CAOpC;AACLN,cAAAA,MAAM,EAAE,SADH;AAELC,cAAAA,OAAO,EAAE,qDAFJ;AAGLE,cAAAA,IAAI,EAAEG;AAHD,aAPoC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA7BF,6BAA6B;AAAA;AAAA;AAAA,GAAnC","sourcesContent":["import MealCategory from '../models/meal_category'\nimport MealCategorySelectionType from '../models/meal_category_selection_type'\nimport User from '../models/user'\nimport { checkIfMarketing } from '../services/RoleService'\nimport { Unauthorized, UnprocessableEntity, NotFound } from '../helpers'\n\nexport const updateMealCategory = async ctx => {\n  const { body } = ctx.request\n  const { role } = ctx.state.user.user\n  let meal_category_id = body.meal_category_id\n  delete body.meal_category_id\n  if (await checkIfMarketing(role)) {\n    if(body.images){\n      body.images = JSON.stringify(body.images)\n    }\n    \n    const meal_category_data = await await MealCategory.query()\n      .patchAndFetchById(meal_category_id, body)\n      .withGraphFetched('[selection_type]')\n      .catch(e => {\n        console.log(e)\n        throw UnprocessableEntity('Invalid Body')\n      })\n    return {\n      status: 'success',\n      message: 'Meal category updated Successfully',\n      ...meal_category_data\n    }\n  } else {\n    throw Unauthorized('Unauthorized')\n  }\n}\n\nexport const getMealCategories = async ctx => {\n  const meal_category_data = await await MealCategory.query()\n    .withGraphFetched('[meal_category_selection_type]')\n    .catch(e => {\n      console.log(e)\n      return []\n    })\n  return {\n    status: 'success',\n    message: 'Meal categories returned Successfully',\n    data: meal_category_data\n  }\n}\n\nexport const getMealCategorySelectionTypes = async ctx => {\n  const meal_category_selection_type_data = await await MealCategorySelectionType.query()\n  //  .withGraphFetched('[meal_categories]')\n    .catch(e => {\n      console.log(e)\n      return []\n    })\n  return {\n    status: 'success',\n    message: 'Meal category selection types returned Successfully',\n    data: meal_category_selection_type_data\n  }\n}\n"],"file":"meal_category.controller.js"}